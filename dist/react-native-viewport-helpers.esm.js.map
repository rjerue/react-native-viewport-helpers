{"version":3,"file":"react-native-viewport-helpers.esm.js","sources":["../src/nativeObserver.tsx","../src/observer.tsx","../src/index.tsx"],"sourcesContent":["import { View, Dimensions } from 'react-native';\n\nexport const nativeObserve = (\n  ref: View,\n  wasVisible: boolean,\n  setIsVisible: (isVisible: () => boolean) => void\n) => {\n  (ref as View).measure((_x, _y, width, height, pageX, pageY) => {\n    const state = {\n      rectTop: pageY,\n      rectBottom: pageY + height,\n      rectWidth: pageX + width,\n    };\n    const window = Dimensions.get('screen');\n    const isVisible =\n      state.rectBottom !== 0 &&\n      state.rectTop >= 0 &&\n      state.rectBottom <= window.height &&\n      state.rectWidth > 0 &&\n      state.rectWidth <= window.width;\n    if (wasVisible !== isVisible) {\n      setIsVisible(() => isVisible);\n    }\n  });\n};\n","import { View } from 'react-native';\nimport { nativeObserve } from './nativeObserver';\n\nexport const observe = (\n  ref: Element | View,\n  isVisible: boolean,\n  setIsVisible: (isVisible: () => boolean) => void\n) => {\n  nativeObserve(ref as View, isVisible, setIsVisible);\n};\n","import * as React from 'react';\nimport { View } from 'react-native';\nimport {\n  useState,\n  useEffect,\n  useLayoutEffect,\n  EffectCallback,\n  useCallback,\n} from 'react';\nimport { observe } from './observer';\n\n/**\n * Hook to run when ref is in view\n * @param ref Ref to be in view\n * @param onVisible Effect to run when in view\n * @param dependencies Dependencies for the hook\n * @param delay delay to poll on, by default 500ms\n */\nexport function useIsInViewPortEffect(\n  ref: React.MutableRefObject<View | HTMLDivElement | null>,\n  onVisible: EffectCallback = () => {},\n  dependencies: any[] = [],\n  delay = 500\n) {\n  const [interval, setVPInterval] = useState<NodeJS.Timeout | null>(null);\n  const [isVisible, setIsVisible] = useState<boolean>(false);\n  const clear = useCallback(() => {\n    if (interval) {\n      clearInterval(interval);\n    }\n    setVPInterval(null);\n  }, [interval]);\n\n  useLayoutEffect(() => {\n    setVPInterval(\n      setInterval(() => {\n        if (!ref.current) {\n          return;\n        }\n        observe(ref.current, isVisible, setIsVisible);\n      }, delay)\n    );\n    return clear;\n  }, [ref, delay, isVisible, ...dependencies]);\n\n  useEffect(() => {\n    if (isVisible) {\n      const effect = onVisible();\n      return effect;\n    }\n  }, [isVisible]);\n  return isVisible;\n}\n"],"names":["nativeObserve","ref","wasVisible","setIsVisible","measure","_x","_y","width","height","pageX","pageY","state","rectTop","rectBottom","rectWidth","window","Dimensions","get","isVisible","observe","useIsInViewPortEffect","onVisible","dependencies","delay","useState","interval","setVPInterval","clear","useCallback","clearInterval","useLayoutEffect","setInterval","current","useEffect","effect"],"mappings":";;;AAEO,IAAMA,aAAa,GAAG,SAAhBA,aAAgB,CAC3BC,GAD2B,EAE3BC,UAF2B,EAG3BC,YAH2B;EAK1BF,GAAY,CAACG,OAAb,CAAqB,UAACC,EAAD,EAAKC,EAAL,EAASC,KAAT,EAAgBC,MAAhB,EAAwBC,KAAxB,EAA+BC,KAA/B;QACdC,KAAK,GAAG;MACZC,OAAO,EAAEF,KADG;MAEZG,UAAU,EAAEH,KAAK,GAAGF,MAFR;MAGZM,SAAS,EAAEL,KAAK,GAAGF;KAHrB;QAKMQ,MAAM,GAAGC,UAAU,CAACC,GAAX,CAAe,QAAf,CAAf;QACMC,SAAS,GACbP,KAAK,CAACE,UAAN,KAAqB,CAArB,IACAF,KAAK,CAACC,OAAN,IAAiB,CADjB,IAEAD,KAAK,CAACE,UAAN,IAAoBE,MAAM,CAACP,MAF3B,IAGAG,KAAK,CAACG,SAAN,GAAkB,CAHlB,IAIAH,KAAK,CAACG,SAAN,IAAmBC,MAAM,CAACR,KAL5B;;QAMIL,UAAU,KAAKgB,SAAnB,EAA8B;MAC5Bf,YAAY,CAAC;eAAMe,SAAN;OAAD,CAAZ;;GAdH;CALI;;ACCA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CACrBlB,GADqB,EAErBiB,SAFqB,EAGrBf,YAHqB;EAKrBH,aAAa,CAACC,GAAD,EAAciB,SAAd,EAAyBf,YAAzB,CAAb;CALK;;ACQP;;;;;;;;AAOA,SAAgBiB,sBACdnB,KACAoB,WACAC,cACAC;MAFAF;IAAAA,YAA4B;;;MAC5BC;IAAAA,eAAsB;;;MACtBC;IAAAA,QAAQ;;;kBAE0BC,QAAQ,CAAwB,IAAxB;MAAnCC;MAAUC;;mBACiBF,QAAQ,CAAU,KAAV;MAAnCN;MAAWf;;MACZwB,KAAK,GAAGC,WAAW,CAAC;QACpBH,QAAJ,EAAc;MACZI,aAAa,CAACJ,QAAD,CAAb;;;IAEFC,aAAa,CAAC,IAAD,CAAb;GAJuB,EAKtB,CAACD,QAAD,CALsB,CAAzB;EAOAK,eAAe,CAAC;IACdJ,aAAa,CACXK,WAAW,CAAC;UACN,CAAC9B,GAAG,CAAC+B,OAAT,EAAkB;;;;MAGlBb,OAAO,CAAClB,GAAG,CAAC+B,OAAL,EAAcd,SAAd,EAAyBf,YAAzB,CAAP;KAJS,EAKRoB,KALQ,CADA,CAAb;WAQOI,KAAP;GATa,GAUX1B,GAVW,EAUNsB,KAVM,EAUCL,SAVD,SAUeI,YAVf,EAAf;EAYAW,SAAS,CAAC;QACJf,SAAJ,EAAe;UACPgB,MAAM,GAAGb,SAAS,EAAxB;aACOa,MAAP;;GAHK,EAKN,CAAChB,SAAD,CALM,CAAT;SAMOA,SAAP;;;;;"}